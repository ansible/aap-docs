[id="eda-set-up-new-credential-types"]

= Creating a new credential type

You can create a credential type to use with a source plugin or a private container registry that you select based on the supported, default credential types. You can make your credential type available to a team or individuals.


.Procedure

. Log in to the {PlatformNameShort} Dashboard.
. From the navigation panel, select {MenuAECredentialType}.
. Click btn:[Create credential type].
. Insert the following:
+
Name:: Insert the name.
Description:: This field is optional.
. In the *Input Configuration* field, specify an input schema that defines a set of ordered fields for that type. The format can be in YAML or JSON:
+
*YAML*
+
[literal, options="nowrap" subs="+attributes"]
----
fields:
  - type: string
    id: username
    label: Username
  - type: string
    id: password
    label: Password
    secret: true
required:
  - username
  - password
----
+

View more YAML examples at the link:https://yaml.org/spec/1.2.2/[YAML page].
+
*JSON*
+
[literal, options="nowrap" subs="+attributes"]
----
{
"fields": [
  {
  "type": "string",
  "id": "username",
  "label": "Username"
  },
  {
  "secret": true,
  "type": "string",
  "id": "password",
  "label": "Password"
   }
  ],
 "required": ["username", "password"]
}
----
+
View more JSON examples at link:https://www.json.org/json-en.html[The JSON website].



. In the *Injector Configuration* field, enter environment variables or extra variables that specify the values a credential type can inject.
The format can be in YAML or JSON (see examples in the previous step).
+
The following configuration in JSON format shows each field and how they are used:
+
[literal, options="nowrap" subs="+attributes"]
----

{
  "file": {
      "template": "[mycloud]\ntoken={{ api_token }}"
  },
  "env": {
      "THIRD_PARTY_CLOUD_API_TOKEN": "{{ api_token }}"
  },
  "extra_vars": {
      "some_extra_var": "{{ username }}:{{ password }}"
  }
}
----
+
Credential Types can also generate temporary files to support `.ini` files or certificate or key data:
+
[literal, options="nowrap" subs="+attributes"]
----
{
  "file": {
      "template": "[mycloud]\ntoken={{ api_token }}"
  },
  "env": {
      "MY_CLOUD_INI_FILE": "{{ tower.filename }}"
  }
}
----
+
In this example, {EDAcontroller} writes a temporary file that has:
+
[literal, options="nowrap" subs="+attributes"]
----
[mycloud]\ntoken=SOME_TOKEN_VALUE
----
+
The absolute file path to the generated file is stored in an environment variable named `MY_CLOUD_INI_FILE`.
+
The following is an example of referencing many files in a custom credential template:
+
*Inputs*
+
[literal, options="nowrap" subs="+attributes"]
----
{
  "fields": [{
    "id": "cert",
    "label": "Certificate",
    "type": "string"
  },{
    "id": "key",
    "label": "Key",
    "type": "string"
  }]
}
----
+
*Injectors*
+
[literal, options="nowrap" subs="+attributes"]
----
{
  "file": {
    "template.cert_file": "[mycert]\n{{ cert }}",
    "template.key_file": "[mykey]\n{{ key }}"
},
"env": {
    "MY_CERT_INI_FILE": "{{ tower.filename.cert_file }}",
    "MY_KEY_INI_FILE": "{{ tower.filename.key_file }}"
}
}
----

. Click btn:[Create credential type].
+
Your newly created credential type is displayed in the list of credential types:

+
image:credential-types-new-listed.png[New credential type]
//[JMS] Replace image with EDA version

. Click the btn:[Edit credential type] image:leftpencil.png[Edit,15,15] icon to modify the credential type options.
+
[NOTE]
====
On the *Edit* page, you can modify the details or delete the credential.
If the *Delete* option is disabled, this means that the credential type is being used by a credential, and you must delete the credential type from all the credentials that use it before you can delete it. 
====

.Verification

* Verify that the newly created credential type can be selected from the *Credential Type* selection window when creating a new credential:
+
image:credential-types-new-listed-verify.png[Verify new credential type]
//[JMS] Replace this image with up to date one, maybe?

.Additional resources

For information about how to create a new credential, see xref:eda-set-up-credential[Setting up credentials].
