:_mod-docs-content-type: CONCEPT

[id="vault-migration-examples-kv2-secret-module"]

= Migration examples for the `hashicorp.vault.kv2_secret` module

[role="_abstract"]

The following examples show basic before and after configurations for the `hashicorp.vault.kv2_secret` module.

[NOTE]
====
KV2 link:https://developer.hashicorp.com/vault/docs/secrets/kv/kv-v2/cookbook/delete-data[delete operations] are `soft-delete`.
====

**Example 1: Basic Secret Write/Create**

Before (`community.hashi_vault`):

----
- name: Write/create a secret
  community.hashi_vault.vault_kv2_write:
    url: https://vault:8200
    path: hello
    data:
      foo: bar
----

After (`hashicorp.vault`):

----
- name: Write/create a secret
  hashicorp.vault.kv2_secret:
    url: https://vault:8200
    path: hello
    data:
      foo: bar
----

**Example 2: Basic Secret Delete**

Before (`community.hashi_vault`):

----
- name: Delete the latest version of the secret/mysecret secret.
  community.hashi_vault.vault_kv2_delete:
    url: https://vault:8201
    path: secret/mysecret
----

After (`hashicorp.vault`):

----
- name: Delete the latest version of the secret/mysecret secret.
  hashicorp.vault.kv2_secret:
    url: https://vault:8201
    path: secret/mysecret
    state: absent
----

**Example 3: Secret Delete - specific version**

Before (`community.hashi_vault`):

----
- name: Delete versions 1 and 3 of the secret/mysecret secret.
  community.hashi_vault.vault_kv2_delete:
    url: https://vault:8201
    path: secret/mysecret
    versions: [1, 3]
----

After (`hashicorp.vault`):

----
- name: Delete versions 1 and 3 of the secret/mysecret secret.
  hashicorp.vault.kv2_secret:
    url: https://vault:8201
    path: secret/mysecret
    versions: [1, 3]
    state: absent
----