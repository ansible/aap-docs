:_mod-docs-content-type: CONCEPT

[id="aap-upgrade-planning_{context}"]

= Upgrade prerequisites
 
[role="_abstract"]
Before you begin the upgrade process, review the following considerations to plan and prepare your {PlatformNameShort} deployment:

== {PlatformNameShort} requirements
* Verify that you have a valid subscription before upgrading from a previous version of {PlatformNameShort}. Existing subscriptions are carried over during the upgrade process. 
* Review link:https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/2.6/html/planning_your_upgrade[Planning your upgrade] to understand the upgrade requirements and scenarios, and {LinkTopologies} for the RPM topologies and infrastructure. 
** Inspect all existing SAML authenticators in your {ControllerName} environment before upgrading from {PlatformNameShort} 2.4 to {PlatformVers}. 
Encrypted private keys for SAML configurations are not supported in {PlatformNameShort} {PlatformVers}. 
For more information, see the link:{URLPlanningUpgrade}/upgrade-authentication-movement-2.4-to-2.6#upgrade-saml-auth[Authentication type: SAML] section in the _Planning your upgrade_ guide.
* Ensure that you are on {PlatformNameShort} 2.4 or 2.5 before upgrading to 2.6. You can only upgrade from {PlatformNameShort} 2.4 or 2.5 to 2.6. 
* Upgrade to the latest version of {PlatformNameShort} 2.4 or 2.5 before upgrading to {PlatformName} 2.6.
+
[IMPORTANT]
====
* When upgrading from {PlatformNameShort} 2.4 to 2.6, the API endpoints for the {ControllerName}, {HubName}, and {EDAcontroller} are all available for use. These APIs are being deprecated and will be disabled in an upcoming release. This grace period is to allow for migration to the new APIs put in place with the {Gateway}.
* If you upgraded from {PlatformNameShort} 2.4 to 2.5, you must migrate your authentication methods and users before upgrading to 2.6 as that legacy authenticator functionality was removed. For information about migrating users, see link:https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/2.5/html/rpm_upgrade_and_migration/aap-post-upgrade#con-migrate-SAML-users_aap-post-upgrade[Migrating Single Sign-On (SSO) users] in _RPM Upgrade and Migration guide_ for 2.5. 
====
* Back up your {PlatformNameShort} environment before upgrading in case any issues occur. See link:{URLUpgrade}/proc-backup-using-automation-installer[Back up the platform using automation installer]. and {LinkOperatorBackup} for the specific topology of the environment.
* Capture your inventory or instance group details before upgrading.
* Review the {Gateway} requirements:
** {PlatformNameShort} 2.4 to 2.6 upgrades include the link:{URLPlanningGuide}/ref-aap-components#con-about-platform-gateway_planning[{Gateway}]. Ensure you review the 2.6 link:{URLPlanningGuide}/network-ports-protocols_planning[Network ports and protocols] for architectural changes.
** {GatewayStart} has a number of associated inventory file variables, some of which are required. For details of the new and changed variables for 2.6, see link:https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/2.6/html/rpm_installation/appendix-inventory-files-vars[Appendix A. Inventory file variables].
** When upgrading from {PlatformNameShort} 2.4 to 2.6, connections to the {Gateway} URL might fail on the {Gateway} UI if you are using the {ControllerName} behind a load balancer. The following error message is displayed: `Error connecting to Controller API`
+
To resolve this issue, for each {ControllerName} host, add the {Gateway} URL as a trusted source in the `CSRF_TRUSTED_ORIGIN` setting in the *settings.py* file for each {ControllerName} host. You must then restart each {ControllerName} host so that the URL changes are implemented. For more information, see _Upgrading_ in {LinkTroubleshootingAAP}. 

* Review the link:{URLPlanningGuide}/ha-redis_planning#gw-centralized-redis_planning[centralized Redis] instance offered by {PlatformNameShort} for both standalone and clustered topologies.
+
** {PlatformNameShort} 2.6 offers a centralized Redis instance in both link:{URLPlanningGuide}/ha-redis_planning#gw-single-node-redis_planning[standalone] and link:{URLPlanningGuide}/ha-redis_planning#gw-clustered-redis_planning[clustered] topologies. For information on how to configure Redis, see link:{URLInstallationGuide}/assembly-platform-install-scenario#redis-config-enterprise-topology_platform-install-scenario[Configuring Redis] in the {TitleInstallationGuide} guide.
** 6 VMs are required for a Redis high availability (HA) compatible deployment. Redis can be colocated on each {PlatformNameShort} component VM except for {ControllerName}, execution nodes, or the PostgreSQL database. 
** External Redis is not supported for RPM-based deployments of {PlatformNameShort}.

* Limitation:
** Upgrade of {EDAName} 2.5 to 2.6 is supported, but upgrade from {EDAName} 2.4 to 2.6 is not supported. Database migrations between {EDAName} 2.4 and {EDAName} 2.6 are not compatible. If you are upgrading from {PlatformNameShort} 2.4 to 2.6 and you deployed {EDAName}, you must first remove the {EDAName} 2.4 database and then upgrade your platform to 2.6. For information about the procedure, see xref:proc-removing-eda-db_aap-upgrading-platform[Removing {EDAName} 2.4 database].

== System requirements


[cols="20%,40%,40%", options="header"]
|====
| Type | Description | Notes 
h| Subscription | Valid {PlatformName} subscription |
h| Operating system  
| {RHEL} 9.4 or later minor versions of {RHEL} 9 | {PlatformName} are also supported on OpenShift, see {LinkOperatorInstallation} for more information.
h| CPU architecture | x86_64, AArch64, s390x (IBM Z), ppc64le (IBM Power) |
h| Ansible-core | Ansible-core version {CoreUseVers} or later | {PlatformNameShort} uses the system-wide ansible-core package to install the platform, but uses ansible-core {CoreUseVers} for both its control plane and built-in execution environments.
h| Browser | A currently supported version of Mozilla Firefox or Google Chrome. |
h| Database 
a| 
* For {PlatformNameShort} managed databases: {PostgresVers}.
* For customer provided (external) databases: {PostgresVers}, 16, or 17.
a| 
* External (customer supported) databases require ICU support.
* External databases using PostgreSQL 16 or 17 must rely on external backup and restore processes. Backup and restore functionality is dependent on utilities provided with {PostgresVers}.
|====

== Database requirements
* {PlatformNameShort} can work with two varieties of database:
** Database installed with {PlatformNameShort} - This database consists of a PostgreSQL installation done as part of an {PlatformNameShort} installation using PostgreSQL packages provided by Red Hat.
** Customer provided or configured database - This is an external database that is provided by the customer, whether on bare metal, virtual machine, container, or cloud hosted service.
{PlatformNameShort} requires customer provided (external) database to have ICU support.
* PostgreSQL user passwords are hashed with SCRAM-SHA-256 secure hashing algorithm before storing in the database.
* Ensure that you back up your {PlatformNameShort} environment before upgrading in case any issues occur. See link:{URLControllerAdminGuide}/controller-backup-and-restore[Backup and restore] and {LinkOperatorBackup} for the specific topology of the environment.

== User privileges
* Ensure a dedicated non-root user is configured on the Red Hat Enterprise Linux host.

** This user requires sudo or other Ansible supported privilege escalation (sudo is recommended) to perform administrative tasks during the installation.
** This user is responsible for the installation of RPM {PlatformNameShort}.
** You can obtain root access either through the sudo command, or through privilege escalation. You can de-escalate privileges from root to users such as AWX, PostgreSQL, {EDAName}, or Pulp.
** An NTP client is configured on each node.

[role="_additional-resources"]
.Additional resources
* link:https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/2.6/html/access_management_and_authentication/assembly-gateway-licensing#proc-attaching-subscriptions[Attaching a subscription]
* link:https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/2.6/html/configuring_automation_execution/controller-backup-and-restore[Backup and restore]
* link:https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/2.6/html/configuring_automation_execution/controller-clustering[Clustering]
* link:https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/2.6/html/planning_your_upgrade/index[Planning your upgrade]
* link:https://docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/2.6/html/planning_your_installation/index[Planning your installation]


