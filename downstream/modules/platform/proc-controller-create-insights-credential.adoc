:_mod-docs-content-type: PROCEDURE

[id="controller-create-insights-credential"]

= Create {RHLightspeed} credentials

[role="_abstract"]
To create a {RHLightspeed} credential, use the following procedure.

.Prerequisites

* To use token-based authentication, you must link:https://docs.redhat.com/en/documentation/red_hat_hybrid_cloud_console/1-latest/html/creating_and_managing_service_accounts/proc-ciam-svc-acct-overview-creating-service-acct#proc-ciam-svc-acct-create-creating-service-acct[create a Red Hat service account] to generate a *Client ID* and *Client secret*. 
* Assign this service account to the appropriate *User Access* group with necessary permissions. 

To enable integration between {PlatformNameShort} and {RHLightspeed}, assign the service account the following permissions:

* *inventory:hosts:read* (included in the Inventory Hosts viewer role)
* *patch:read* (included in the Patch viewer role)
* *remediations:remediation:read* and *playbook-dispatcher:run:read* (included in the Remediations user role)

You might consider associating your service account with an existing user access group that already has the required permissions, or creating a new user access group. 

[NOTE]
====
In adherence to security guidelines, service accounts are not automatically included in the default access group. 
To grant access, you must manually add them to the appropriate user access groups.

If you are not an organization administrator, you can create a service account and then ask your administrator to add your account to the appropriate user access groups.
====

After you have created a service account and assigned it the appropriate permissions, you can create a new credential for use with {RHLightspeed}.

.Procedure

. From the navigation panel, select {MenuAECredentials}.
. Click btn:[Create credential].
. Enter the appropriate details in the following fields:

* *Name*: Enter the name of the credential.
* Optional: *Description*: Enter a description for the credential.
* Optional: *Organization*: Enter the name of the organization with which the credential is associated, or click the search image:search.png[Search,15,15] icon and select it from the *Select organization* window.
* *Credential type*: Enter *{RHLightspeed}* or select it from the list.
+
// [commenting out until UI has updated with rebranded RH lightspeed credential -hherbly]image::ug-credential-types-popup-window-insights.png[Credentials {RHLightspeed} pop up]
// +
// * *Username*: Enter a valid {RHLightspeed} credential. 
// * *Password*: Enter a valid {RHLightspeed} credential.
// +
// The {RHLightspeed} credentials are the user's link:https://access.redhat.com/[Red Hat Customer Portal] account username and password.
+
[NOTE]
====
Use the *Username* and *Password* fields for Basic authentication. 
You can leave these blank if using *Client ID* and *Client secret*.
====
+
* *Client ID*: Enter the client ID you received when you created your service account. 
* *Client secret*: Enter the client secret you received when you created your service account. 

. Click btn:[Create credential].
+
You can now use this credential in an xref:proc-controller-inv-source-insights[{RHLightspeed}-sourced inventory] and xref:controller-create-insights-project[{RHLightspeed} project].

.Troubleshooting

* If you receive a project sync failure, see the steps in xref:controller-remediate-insights-inventory[Remediating a {RHLightspeed} inventory] and check your analytics logs.

[IMPORTANT]
====
* You must recreate existing credentials and reassociate them with existing projects and inventory sources to support token-based authentication.
//Note: The following is true for now, but there is a plan to fix this come Q3 or Q4. 
//* Only remediations you create using the service account are visible in {PlatformNameShort} for that account. 
//This aligns with the current policy, which does not allow a user to view remediations created by other users.
//* For more information about the {RHLightspeed} inventory source plugin, see link:https://console.redhat.com/ansible/automation-hub/repo/published/redhat/insights/content/inventory/insights?extIdCarryOver=true&intcmp=701f2000001OEGhAAO&percmp=7013a000002ppOOAAY&sc_cid=7013a000002q6eLAAQ[inventory > insights] in {HubName}.
====

[role="_additional-resources"]
.Additional resources

* link:https://docs.redhat.com/en/documentation/red_hat_hybrid_cloud_console/1-latest/html/creating_and_managing_service_accounts/proc-ciam-svc-acct-overview-creating-service-acct[Creating and Managing Service Accounts]
* link:https://www.youtube.com/watch?v=UvNcmJsbg1w[How to use Service Accounts on the Hybrid Cloud Console]
* link:https://access.redhat.com/articles/7108804[Support for token-based authentication via Service Account for Red Hat Lightspeed in Ansible Automation Platform]
