[id="proc-update-aap-rpm"]

== Update planning

Before you begin the update process, review the following considerations to plan and prepare your {PlatformNameShort} deployment:

* Even if you have a valid license from a previous version, you must provide your credentials or a subscription manifest upon upgrading to the latest version of {PlatformNameShort}. For more information, see link:docs.redhat.com/en/documentation/{PlatformName}/2.5/html/access_management_and_authentication/assembly-gateway-licensing#proc-attaching-subscriptions[Attaching your {PlatformName} subscription].

* Clustered upgrades require special attention to instance and instance groups before upgrading. Ensure you capture your inventory or instance group details before upgrading. For more information, see link:docs.redhat.com/en/documentation/{PlatformName}/2.5/html-single/configuring_automation_execution/index#controller-clustering[Clustering].

* If you are currently running {EDAcontroller}, it is recommended that you disable all rulebook activations before upgrading to ensure that only new activations run after the upgrade process has completed. This prevents possibilities of orphaned containers running activations from the previous version. For more information, see link:docs.redhat.com/en/documentation/{PlatformName}/2.5/html-single/using_automation_decisions/index#eda-enable-rulebook-activations[Enabling and disabling rulebook activations].

== Choosing and obtaining a {PlatformName}installer

Choose the {PlatformName} installer you need based on your {RHEL} environment internet connectivity. Review the following scenarios and decide on which {PlatformNameShort} installer meets your needs.
Note

A valid Red Hat customer account is required to access {PlatformName} installer downloads on the Red Hat Customer Portal.

== Installing with internet access

*Tarball install*

.Procedure

. Navigate to the link:access.redhat.com/downloads/content/480/ver=2.5/rhel---9/2.5/x86_64/product-software[{PlatformName} download download] page.

. Click btn:[Download Now] for the {PlatformNameShort} <latest-version> Setup.

. Extract the files:
+
[literal, options="nowrap" subs="+attributes"]
----
$ tar xvzf ansible-automation-platform-setup-<latest-version>.tar.gz
----
+
*RPM install*

* Install {PlatformNameShort} Installer Package
+
[literal, options="nowrap" subs="+attributes"]
v.2.5 for RHEL 8 for x86_64
+
----
$ sudo dnf install --enablerepo=ansible-automation-platform-2.5-for-rhel-8-x86_64-rpms ansible-automation-platform-installer
----
+
v.2.5 for RHEL 9 for x86-64
+
----
$ sudo dnf install --enablerepo=ansible-automation-platform-2.5-for-rhel-9-x86_64-rpms ansible-automation-platform-installer
----

Note: `dnf install` enables the repo as the repo is disabled by default.

== Installing without internet access

Use the {PlatformNameShort} bundle installer if you are unable to access the internet, or would prefer not to install separate components and dependencies from online repositories. Access to {RHEL} repositories is still needed. All other dependencies are included in the tar archive.

.Procedure

. Navigate to the link:access.redhat.com/downloads/content/480/ver=2.5/rhel---9/2.5/x86_64/product-software[{PlatformName} download download] page.

. Click btn:[Download Now] for the {PlatformNameShort} <latest-version> Setup.

. Extract the files:
+
[literal, options="nowrap" subs="+attributes"]
----
+$ tar xvzf ansible-automation-platform-setup-bundle-<latest-version>.tar.gz
----

== Setting up the inventory file

Before upgrading your {PlatformName} installation, edit the `inventory file so that it matches your desired configuration. You can keep the same parameters from your existing Ansible Automation Platform deployment or you can modify the parameters to match any changes to your environment.

.Procedure

. Navigate to the installation program directory.

*Bundled installer*
+
[literal, options="nowrap" subs="+attributes"]
----
$ cd ansible-automation-platform-setup-bundle-<version_number>-<arch_version>
----
+
*Online installer*
----
$ cd ansible-automation-platform-setup-<version_number>
----

. Update the `inventory` file to match your desired configuration. You can use the same inventory file from an existing {PlatformNameShort} installation if there are no changes to the environment.

Note: Provide a reachable IP address or fully qualified domain name (FQDN) for all hosts to ensure that users can synchronize and install content from Ansible automation hub from a different node. Do not use localhost. If localhost is used, the upgrade will be stopped as part of preflight checks.

== Backing up RPM-based Ansible Automation Platform

Back up an existing {PlatformNameShort} instance by running the `setup.sh` script with the `backup_dir` flag, which saves the content and configuration of your current environment:

. Go to your Ansible Automation Platform installation directory.

. Run the setup.sh script following the example below:
+
[literal, options="nowrap" subs="+attributes"]
----
$ ./setup.sh -e ‘backup_dir=/ansible/mybackup’ -e ‘use_compression=True’ @credentials.yml -b
+
* `backup_dir` specifies a directory to save your backup to.
+
* `@credentials.yml` passes the password variables and their values that are encrypted by `ansible-vault`.

With a successful backup, a backup file is created at `/ansible/mybackup/<platform_installation_directory_name>.tar.gz`.

*Additional resources*

* For more information about backup and restore, see [Backup and restore] in link:docs.redhat.com/en/documentation/{PlatformNameShort}/2.5/html-single/configuring_automation_execution/index#controller-backup-and-restore_Configuring automation execution_.

== Running the {RHEL} installer setup script

You can run the setup script once you have finished updating the `inventory` file.

.Procedure
. Run the `setup.sh` script:
[literal, options="nowrap" subs="+attributes"]
+
----
$ ./setup.sh
----

The installation will begin.