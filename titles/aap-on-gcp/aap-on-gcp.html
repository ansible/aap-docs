<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Red Hat Ansible Automation Platform from GCP guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-left Role ARG Spec">
<div id="header">
<h1>Red Hat Ansible Automation Platform from GCP guide</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_aaponawsnameshort">{AAPonAWSNameShort}</a></li>
<li><a href="#making-open-source-more-inclusive">Making open source more inclusive</a></li>
<li><a href="#assembly-intro-to-aap-on-gcp">1. Introduction to Ansible Automation Platform frm GCP Marketplace</a>
<ul class="sectlevel2">
<li><a href="#con-gcp-application-architecture">1.1. Application architecture</a></li>
<li><a href="#_gcp_infrastructure">1.2. GCP infrastructure</a></li>
<li><a href="#_architecture_description">1.3. Architecture Description</a></li>
<li><a href="#_service_descriptions">1.4. Service descriptions</a></li>
</ul>
</li>
<li><a href="#assembly-aap-gcp-install">2. Installing Ansible Automation Platform from GCP Marketplace</a>
<ul class="sectlevel2">
<li><a href="#ref-aap-gcp-install-prerequisites">2.1. Prerequisites</a></li>
<li><a href="#con-aap-gcp-create-project">2.2. Create a project</a>
<ul class="sectlevel3">
<li><a href="#con-aap-gcp-required-apis">2.2.1. Required APIs</a></li>
<li><a href="#con-aap-gcp-service-account">2.2.2. Your service account</a></li>
</ul>
</li>
<li><a href="#proc-gcp-marketplace">2.3. GCP Marketplace</a></li>
<li><a href="#proc-aap-gcp-application-deploy_aap-gcp-install">2.4. Application deployment</a></li>
</ul>
</li>
<li><a href="#assembly-aap-gcp-networking-access">3. Networking and application access</a>
<ul class="sectlevel2">
<li><a href="#con-aap-gcp-network-peering-options">3.1. Network peering options</a></li>
<li><a href="#proc-aws-vpc-peering">3.2. VPC peering</a></li>
<li><a href="#ref-aap-gcp-external-load-balancer">3.3. Using an external load balancer</a></li>
</ul>
</li>
<li><a href="#assembly-aap-gcp-additional-configs">4. Ansible Automation Platform on GCP additional configurations</a>
<ul class="sectlevel2">
<li><a href="#ref-aap-gcp-additional-configs-update-admin-password">4.1. Changing the default Ansible Automation Platform administrator password</a></li>
<li><a href="#ref-aap-gcp-security-considerations">4.2. Security considerations</a></li>
</ul>
</li>
<li><a href="#assembly-aap-gcp-automation-workloads">5. Automation workloads</a>
<ul class="sectlevel2">
<li><a href="#ref-aap-gcp-automation-performance">5.1. Automation performance</a></li>
<li><a href="#ref-aap-gcp-deployment-scaling">5.2. Deployment scaling</a></li>
</ul>
</li>
<li><a href="#assembly-aap-gcp-monitoring-logging">6. Monitoring and logging</a></li>
<li><a href="#_configuration">7. Configuration</a>
<ul class="sectlevel2">
<li><a href="#ref-aap-gcp-ansible-podman-config">7.1. Ansible and podman configuration</a></li>
<li><a href="#proc-aap-gcp-change-config-controller-hub">7.2. Changing the configuration of automation hub or automation controller</a></li>
<li><a href="#proc-aap-gcp-configure-google-cloud-ops-agent">7.3. Google cloud ops agent configuration</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Install and configure Red Hat Ansible Automation Platform from GCP.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_aaponawsnameshort"><a class="anchor" href="#_aaponawsnameshort"></a>{AAPonAWSNameShort}</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Thank you for your interest in Red Hat Ansible Automation Platform from GCP.
Ansible Automation Platform is a commercial offering that helps teams manage complex multi-tier deployments by adding control, knowledge, and delegation to Ansible-powered environments.</p>
</div>
<div class="paragraph">
<p>This guide helps you to understand the installation and use of Ansible Automation Platform from GCP.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="making-open-source-more-inclusive"><a class="anchor" href="#making-open-source-more-inclusive"></a>Making open source more inclusive</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Red Hat is committed to replacing problematic language in our code, documentation, and web properties.
We are beginning with these four terms: master, slave, blacklist, and whitelist.
Because of the enormity of this endeavor, these changes will be implemented gradually over several upcoming releases.
For more details, see <a href="https://www.redhat.com/en/blog/making-open-source-more-inclusive-eradicating-problematic-language">our CTO Chris Wright&#8217;s message</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-intro-to-aap-on-gcp"><a class="anchor" href="#assembly-intro-to-aap-on-gcp"></a>1. Introduction to Ansible Automation Platform frm GCP Marketplace</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Red Hat Ansible Automation Platform from GCP Marketplace is an offering that you can deploy from the GCP Marketplace portal.
Ansible Automation Platform from GCP Marketplace provides access to a library of Ansible content collections, and it is integrated with key GCP services, so you can start automating the deployment, configuration, and management of infrastructure and applications quickly.</p>
</div>
<div class="paragraph">
<p>The following Red Hat Ansible Automation Platform components are available on Ansible Automation Platform from GCP Marketplace:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Automation controller</p>
</li>
<li>
<p>Ansible automation hub</p>
</li>
<li>
<p>Private automation hub</p>
</li>
<li>
<p>Automation services catalog</p>
</li>
<li>
<p>Ansible Content Collections</p>
</li>
<li>
<p>Automation execution environments</p>
</li>
<li>
<p>Ansible content tools, including access to Red Hat Insights for Red Hat Ansible Automation Platform</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Automation mesh is not available on Ansible Automation Platform from GCP Marketplace at this time and is planned for a later release.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="con-gcp-application-architecture"><a class="anchor" href="#con-gcp-application-architecture"></a>1.1. Application architecture</h3>
<div class="paragraph">
<p>Red Hat Ansible Automation Platform from GCP Marketplace is installed into infrastructure resources running within your GCP account.</p>
</div>
</div>
<div class="sect2">
<h3 id="_gcp_infrastructure"><a class="anchor" href="#_gcp_infrastructure"></a>1.2. GCP infrastructure</h3>
<div class="imageblock">
<div class="content">
<img src="images/aap-on-gcp-architecture.png" alt="GCP application architecture">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_architecture_description"><a class="anchor" href="#_architecture_description"></a>1.3. Architecture Description</h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="_service_descriptions"><a class="anchor" href="#_service_descriptions"></a>1.4. Service descriptions</h3>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Service Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute Engine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCP VM compute platform</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud SQL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCP database service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filestore</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCP file storage service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual Private Cloud (VPC)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCP networking service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud monitoring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCP metrics collector</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud loging</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCP log management Service</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAT Gateway</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A NAT gateway is a <em>Network Address Translation</em> (NAT) service</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-aap-gcp-install"><a class="anchor" href="#assembly-aap-gcp-install"></a>2. Installing Ansible Automation Platform from GCP Marketplace</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="ref-aap-gcp-install-prerequisites"><a class="anchor" href="#ref-aap-gcp-install-prerequisites"></a>2.1. Prerequisites</h3>
<div class="paragraph">
<p>Before you can install and register Ansible Automation Platform, you must be familiar with GCP including how services operate, how data is stored, and any privacy implications that may exist by using these services.
You must also set up an account with <em>Google Cloud Platform</em> (GCP).</p>
</div>
<div class="paragraph">
<p>You must have a working knowledge of the following aspects of Google Cloud Platform:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Deploying solutions from the GCP Marketplace</p>
</li>
<li>
<p>Compute engine <em>Virtual machine</em> (VM) instances</p>
</li>
<li>
<p><em>Elastic Block Store</em> (EBS) volumes</p>
</li>
<li>
<p>Cloud SQL for PostgreSQL</p>
</li>
<li>
<p>Filestore</p>
</li>
<li>
<p>GPC <em>Virtual Private Clouds</em> (VPCs)</p>
<div class="ulist">
<ul>
<li>
<p>Subnets</p>
</li>
<li>
<p>Route Tables</p>
</li>
<li>
<p>Security Groups</p>
</li>
<li>
<p>Load Balancers</p>
</li>
</ul>
</div>
</li>
<li>
<p>Network Design</p>
<div class="ulist">
<ul>
<li>
<p>Hub-and-spoke networking designs</p>
</li>
<li>
<p>VPC Peering</p>
</li>
<li>
<p><em>Class Inter-Domain Routing</em> (CIDR) blocks</p>
</li>
<li>
<p>Transit routing</p>
</li>
</ul>
</div>
</li>
<li>
<p>GCP Cloud monitoring</p>
<div class="ulist">
<ul>
<li>
<p>GCP Ops agent</p>
</li>
</ul>
</div>
</li>
<li>
<p>SSH</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information about Google Cloud Platform and terminology, see the <a href="https://cloud.google.com//">GCP product documentation</a>.</p>
</div>
<div class="paragraph">
<p>Your GCP account must have <em>Identity and Access Management</em> (IAM) permissions to create and manage GCP Marketplace deployments as well as the resources described in <a href="#con-gcp-application-architecture">Application architecture</a>.
The application can fail to deploy if your IAM policies restrict deployment and management of these resources.</p>
</div>
</div>
<div class="sect2">
<h3 id="con-aap-gcp-create-project"><a class="anchor" href="#con-aap-gcp-create-project"></a>2.2. Create a project</h3>
<div class="paragraph">
<p>To install Ansible Automation Platform, you must create a project in your Google Cloud Platform account to host the application if you do not already have one.
See <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects">Creating and managing projects</a> in the GCP documentation.</p>
</div>
<div class="sect3">
<h4 id="con-aap-gcp-required-apis"><a class="anchor" href="#con-aap-gcp-required-apis"></a>2.2.1. Required APIs</h4>
<div class="paragraph">
<p>Your GCP project requires access to several API services to complete the Ansible Automation Platform installation.
On deployment, the Ansible Automation Platform installation automatically attempts to enable the followwing APIs.
If you prefer, you can enable the APIs ahead of time to ensure they are permitted by your organization.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">API Service</th>
<th class="tableblock halign-left valign-top">Console service name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Compute Engine API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>compute.googleapis.com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Google Cloud APIs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cloudapis.googleapis.com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Identity and Access Management (IAM) API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>iam.googleapis.com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud SQL Admin API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>sql-component.googleapis.com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud Logging API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logging.googleapis.com</code></p>
<p class="tableblock">See <a href="#assembly-aap-gcp-monitoring-logging">Monitoring and logging</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud Monitoring API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>monitoring.googleapis.com</code></p>
<p class="tableblock">See <a href="#assembly-aap-gcp-monitoring-logging">Monitoring and logging</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud Resource Manager API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>cloudresourcemanager.googleapis.com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud Identity-Aware Proxy API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>iap.googleapis.com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Secret Manager API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>secretmanager.googleapis.com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service Networking API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>servicenetworking.googleapis.com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Service Usage API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>serviceusage.googleapis.com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OS Config API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>osconfig.googleapis.com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud Runtime Configuration API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>runtimeconfig.googleapis.com</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cloud Filestore API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>file.googleapis.com</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="con-aap-gcp-service-account"><a class="anchor" href="#con-aap-gcp-service-account"></a>2.2.2. Your service account</h4>
<div class="paragraph">
<p>You must have a service account to set up Ansible Automation Platform from GCP Marketplace.
This account is used to install and configyure the application and remains associated with the Ansible Automation Platform virtual machines.
You can use an existing service account with the required roles, or you can permit the Ansible Automation Platform deployment to create one with the required roles on your behalf.
If you use an existing account, it must have the following roles:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Editor</p>
</li>
<li>
<p>Logs Writer</p>
</li>
<li>
<p>Cloud SQL Client</p>
</li>
<li>
<p>Cloud SQL Instance User</p>
</li>
<li>
<p>Secret Manager Secret Accessor</p>
</li>
<li>
<p>Compute Network Admin</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See <a href="https://cloud.google.com/iam/docs/granting-changing-revoking-access#single-role">Grant a single role</a> for steps to add the required roles to your existing service account.</p>
</div>
<div class="paragraph">
<p>The Compute Network Aministrator role is only required at the time of deployment to configure the application properly.
When installation and configuration are complete, this role can be removed from the service account, which remains configured on the Ansible Automation Platform Virtual Machines.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="proc-gcp-marketplace"><a class="anchor" href="#proc-gcp-marketplace"></a>2.3. GCP Marketplace</h3>
<div class="paragraph">
<div class="title">Public Offer</div>
<p>Red Hat Ansible Automation Platform from GCP Marketplace can be obtained directly from the GCP Marketplace.
Follow these steps to purchase and deploy the public offer.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Google Cloud Console, navigate to the <strong>Marketplace</strong>.</p>
</li>
<li>
<p>Click btn:[Discover Products].</p>
</li>
<li>
<p>Search for Ansible Automation Platform.</p>
</li>
<li>
<p>Click the listing for <strong>Red Hat Ansible Automation Platform from GCP Marketplace</strong>.
Ensure that you have selected the offer where Red Hat is the publisher.</p>
</li>
<li>
<p>Click btn:[Continue to Launch].</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Private Offer</div>
<p>If you have worked with Red Hat Sales to enable a private offer of Red Hat Ansible Automation Platform from GCP Marketplace, follow the steps in <a href="https://cloud.google.com/marketplace/docs/accepting-private-offer">Accepting a private offer</a> to accept your offer and deploy the solution.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>After subscribing, the offer is also listed in your <a href="https://us-east-1.console.aws.amazon.com/marketplace/home#/subscriptions">GCP Marketplace Subscriptions</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="proc-aap-gcp-application-deploy_aap-gcp-install"><a class="anchor" href="#proc-aap-gcp-application-deploy_aap-gcp-install"></a>2.4. Application deployment</h3>
<div class="paragraph">
<p>Now that you have subscribed to an offer, you can begin configuration before launching the application.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A temporary yet necessary constraint has been placed on the length of deployment names.
This is due to GCP&#8217;s naming schemes for internal components that make up an Ansible Automation Platform deployment.
Component names based on this naming scheme can get too long and often break naming constraints imposed by other services creating deployment errors.</p>
</div>
<div class="paragraph">
<p>The length of the name of your deployment, plus the length of your GCP project name must be less than 36 characters.</p>
</div>
<div class="paragraph">
<p>The calculation below will help you find the maximum length of the name of an Ansible Automation Platform deployment in your project.</p>
</div>
<div class="paragraph">
<p>length of deployment name &lt; = 36 - length(gcp_project_name)</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure (TO CHANGE)</div>
<ol class="arabic">
<li>
<p>In the <strong>Fulfillment option</strong> field, select <strong>Ansible Automation Platform CloudFormation</strong>.</p>
</li>
<li>
<p>In the <strong>Software version</strong> field, confirm the latest version available in the list is selected.</p>
</li>
<li>
<p>In the <strong>Region</strong> field, select the region with your EC2 key pair.
The CloudFormation Stack deploys in the same region.</p>
</li>
<li>
<p>Click btn:[Continue to Launch].</p>
</li>
<li>
<p>On the following screen, click btn:[Launch].
This launches the AWS CloudFormation Console in a new browser tab.</p>
</li>
<li>
<p>For Step 1, <strong>Specify template</strong>, click btn:[Next].</p>
</li>
<li>
<p>For Step 2, <strong>Specify stack details</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the <strong>Stack name</strong> field, enter a unique stack name.</p>
</li>
<li>
<p>For <strong>awsKeyPair</strong> select your previously created EC2 keypair.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click btn:[Next] to move to Step 3.</p>
</li>
<li>
<p>For Step 3, <strong>Configure stack options</strong>.
No changes are necessary.
All configurations are optional or have the correct default values.</p>
</li>
<li>
<p>Click btn:[Next] to move to Step 4, <strong>Review</strong>.</p>
</li>
<li>
<p>For Step 4, <strong>Review</strong>.
Scroll to the bottom.
In the <strong>Capabilities section</strong>, check to acknowledge that CloudFormation may create IAM resources.</p>
</li>
<li>
<p>Click btn:[Create stack].</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The application begins provisioning.
It can take some time for the infrastructure and application to fully provision.</p>
</div>
<div class="paragraph">
<p>TODO: Include details on Networking options in the Launch,</p>
</div>
<div class="paragraph">
<p>TODO: Include blurb that the warning about RuntimeConfig is expected and ok. “​​This deployment has resources from the Runtime Configurator service, which is in Beta. There is no planned date for moving this feature into General Availability (GA). Examples of runtimeconfig types used: runtimeconfig.v1beta1.config, runtimeconfig.v1beta1.waiter”</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-aap-gcp-networking-access"><a class="anchor" href="#assembly-aap-gcp-networking-access"></a>3. Networking and application access</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When Ansible Automation Platform on GCP is deployed, it is deployed into an isolated VPC and cannot be accessed.
The following instructions describe how to connect the VPC used by Ansible Automation Platform on GCP to your existing GCP network.
When connected, you must determine how your users connect to Ansible Automation Platform.</p>
</div>
<div class="paragraph">
<p>There are many ways to enable this connectivity such as VPNs, Google Cloud Interconnect, or bastion servers for private network access.
You can also expose the platform with public internet access using GCP services such as a Load Balancer.</p>
</div>
<div class="paragraph">
<p>How your organization configures application access on GCP is outside the scope of Red Hat’s guidelines and support for Ansible Automation Platform on GCP.
See <a href="https://cloud.google.com/solutions/connecting-securely#external">Securely connecting to VMs</a> for guidelines on these topics.</p>
</div>
<div class="sect2">
<h3 id="con-aap-gcp-network-peering-options"><a class="anchor" href="#con-aap-gcp-network-peering-options"></a>3.1. Network peering options</h3>
<div class="paragraph">
<p>Many networking configurations are possible, but the following configurations have been validated to work with Ansible Automation Platform on GCP by Red Hat.</p>
</div>
<div class="paragraph">
<p>Private deployments omit access from the public internet.
This is the default deployment model based on the GCP architecture used by Ansible Automation Platform on GCP.</p>
</div>
<div class="paragraph">
<p>If you use this approach you must configure VPC peering, a transit network gateway, or similar GCP networking connectivity to access Ansible Automation Platform on GCP.</p>
</div>
<div class="paragraph">
<p>When VPC peering and routing are configured, you can access Ansible Automation Platform through a VM on a connected VPC subnet, or directly if your organization has a transit routing setup between GCP and your local networks.</p>
</div>
<div class="paragraph">
<p>Ansible Automation Platform requires peering and routing for outbound communication to perform automations against devices on your AWS networks and connected on-prem or multi-cloud networks.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>VPC peering is required for Ansible Automation Platform to access resources that reside on private VPCs or where transit routing between Google Cloud Platform and your on-premises network(s) exist.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>While every effort has been made to align with Google Cloud Platform’s documentation for this content, there may be a drift in accuracy over time.
Use <a href="https://cloud.google.com/vpc/docs/vpc-peering">GCP documentation</a> as the source of information regarding networking topics for GCP.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Peering type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cloud.google.com/vpc/docs/vpc-peering">VPC Peering</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VPCs are individually connected to one another with no other routing hops between them.
This is a simple peering model and is useful when connecting a few networks.
Complex peering can be configured, but routing can become more complex over time.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="proc-aws-vpc-peering"><a class="anchor" href="#proc-aws-vpc-peering"></a>3.2. VPC peering</h3>
<div class="paragraph">
<p>VPC Peering offers the ability to directly connect different networks within your AWS infrastructure.
When two or more networks are peered, the peering only establishes the connection between the networks.
You must also update routing tables to direct the networks to send traffic over the appropriate networking peer.</p>
</div>
<div class="paragraph">
<div class="title">Prerequisites</div>
<p>Before using VPC peering to connect any VPC, you must ensure that there is no network address space overlap between the networks that you intend to route traffic between your VPCs and Ansible Automation Platform from GCP Marketplace’s VPC address space.
Google should prevent peering if this is attempted.</p>
</div>
<div class="paragraph">
<p>The following procedure lets you configure VPC peering with Ansible Automation Platform.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the GCP Portal, navigate to menu:VPC[].</p>
</li>
<li>
<p>In the <strong>VPC menu</strong>, click btn:[VPC Network Peering].</p>
</li>
<li>
<p>Click btn:[Create peering connection].</p>
</li>
<li>
<p>In the <strong>Name</strong> field, enter the name of the peering connection as you need.</p>
</li>
<li>
<p>In the <strong>Your VPC Network</strong> field, select the first VPC that you plan to peer.</p>
</li>
<li>
<p>In the <strong>Peered VPC Network</strong> field, select the second VPC to peer.
This can be the Ansible Automation Platform from GCP Marketplace VPC.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Subnet routes between these two networks are created by default.
Therefore, access to Ansible Automation Platform can occur from VMs that reside on the peered VPC.
However, if you have more complex routing, such as a hub-and-spoke network model, then other route must be created.</p>
</li>
<li>
<p>Select <strong>Exchange custom routes</strong> and <strong>Exchange subnet routes with public IP</strong> carefully.
Google provides explanations what each fields does.
Your selection impact how traffic flows through your VPCs.
Under the proper conditions, these checkboxes configure routing between the newly peered networks and other networks through the route table exchange enabling network traffic to traverse multiple networks (transit routing).</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click btn:[Create].</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For additional information on routing tables, firewalls and other networking components, see [here]</p>
</div>
</div>
<div class="sect2">
<h3 id="ref-aap-gcp-external-load-balancer"><a class="anchor" href="#ref-aap-gcp-external-load-balancer"></a>3.3. Using an external load balancer</h3>
<div class="paragraph">
<p>It is possible to expose Ansible automation controller and Ansible private automation hub to the public internet if you wish users to have access to the platform from any internet connected machine.
This is not recommended as a best practice for security reasons, but this implementation can be secured with different GCP tools.  This section describes how to connect a load balancer that faces the public internet, but it does not include steps to harden access through Google’s security products.
Only use this approach if you intend to protect the public endpoints with <a href="https://cloud.google.com/armor/">Google Cloud Armor</a> or similar product(s).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Ansible Automation Platform from GCP Marketplace is deployed with two internal application load balancers.
These load balancers direct traffic within local VPCs and should remain part of the deployment even if you configure public load balancers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Select the main menu from the top left.</p>
</li>
<li>
<p>Select <strong>Network Services</strong>.
If you do not see <strong>Network Services</strong>, then select <strong>View All Products</strong>.</p>
</li>
<li>
<p>Select <strong>Load Balancing</strong>.</p>
</li>
<li>
<p>In the top menu, select <strong>CREATE LOAD BALANCER</strong>.</p>
</li>
<li>
<p>Select the <strong>HTTP(S) Load Balancing</strong> tile and click btn:[START CONFIGURATION].</p>
</li>
<li>
<p>Ensure that <strong>Frontend</strong> configuration is selected at the left of the screen.</p>
</li>
<li>
<p>Select <strong>From Internet to my VMs</strong> or <strong>Serverless services and Global HTTP(s) Load Balancer</strong>.</p>
</li>
<li>
<p>Click btn:[CONTINUE].</p>
</li>
<li>
<p>Enter the required fields on the <strong>Frontend</strong> configuration page.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Only use HTTPS as the <strong>Protocol</strong> for internet-facing applications.</p>
</li>
<li>
<p>You can use your own <strong>SSL certificate</strong>, or use a Google managed certificate.</p>
</li>
<li>
<p><strong>IP Address</strong> should be set to a static IP address so that you do not risk accidentally deleting it.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click btn:[Backend configuration] from the menu on the left.</p>
</li>
<li>
<p>Click the <strong>Create</strong> drop-down, or select <strong>Backend services</strong>.</p>
</li>
<li>
<p>Click btn:[CREATE A BACKEND SERVICE].</p>
</li>
<li>
<p>In the <strong>Instance group</strong> field, set the Backend type.</p>
</li>
<li>
<p>Set the <strong>Protocol</strong> to <code>HTTP</code> and <strong>Named Port</strong> to <code>http</code>.</p>
</li>
<li>
<p>Change the <strong>Timeout</strong> to <code>300</code>.</p>
</li>
<li>
<p>Scroll down to the <strong>Backends</strong> section and in the <strong>New backend</strong> field, select the <strong>Instance group</strong> drop-down and select the instance group that has <code>-aap-cntrlr-igm</code> at the end of its name.</p>
</li>
<li>
<p>In the resulting dialog box, select <strong>USE EXISTING PORT NAME</strong>.</p>
</li>
<li>
<p>Scroll down until you see a text box showing <strong>Health check</strong>.</p>
</li>
<li>
<p>Select the drop-down menu and click btn:[CREATE A HEALTH CHECK].</p>
</li>
<li>
<p>In the <strong>Health Check</strong> dialog box, set <strong>Protocol</strong> to <code>TCP</code>, and <strong>Port</strong> to <code>8052</code>.</p>
</li>
<li>
<p>Set <strong>Request</strong> to <code>/api/v2/ping/</code>.</p>
</li>
<li>
<p>Keep all other default settings.</p>
</li>
<li>
<p>Click btn:[SAVE].
This returns you to the <strong>Create backend services</strong> window.</p>
</li>
<li>
<p>Click btn:[CREATE].
This returns you to <strong>Backend configuration</strong> section.</p>
</li>
<li>
<p>Click btn:[OK].</p>
</li>
<li>
<p>Click btn:[CREATE] to create the load balancer for the automation controller UI.
This will take a few minutes to complete.
A load balancer has now been created.</p>
</li>
<li>
<p>Configure the DNS record for the domain that you used in your SSL certificate to point to the IP address of the load balancer.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>At this point you should have accesss to the Ansible Automation Platform automation controller UI.
You can log after you retrieve the admin password.
Repeat the same process for private automation hub.
The process is identical except for selecting the instance group <code>-aap-hub-igm</code> during backend configuration</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-aap-gcp-additional-configs"><a class="anchor" href="#assembly-aap-gcp-additional-configs"></a>4. Ansible Automation Platform on GCP additional configurations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TBD</p>
</div>
<div class="sect2">
<h3 id="ref-aap-gcp-additional-configs-update-admin-password"><a class="anchor" href="#ref-aap-gcp-additional-configs-update-admin-password"></a>4.1. Changing the default Ansible Automation Platform administrator password</h3>
<div class="paragraph">
<p>The default administrator password for Ansible Automation Platform is generated randomly when Ansible Automation Platform from GCP Marketplace is deployed.
Follow these steps to change the administrator password for both automation controller and automation hub.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Locate the correct secret for the Ansible Automation Platform deployment by opening the GCP Secrets Manager console and selecting the secret with the name <em>&lt;deployment_name&gt;-aap-admin</em>.</p>
</li>
<li>
<p>Select <strong>NEW VERSION</strong> to add a new version.</p>
</li>
<li>
<p>Enter a password secret value.</p>
</li>
<li>
<p>Check <strong>Disable all past versions</strong></p>
</li>
<li>
<p>Click btn:[ADD NEW VERSION]</p>
</li>
<li>
<p>Replace the running Ansible Automation Platform VM instances to use the new administrator password.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Navigate to the <strong>GCP VM Instances</strong> console.</p>
</li>
<li>
<p>Identify and delete one automation controller VM instance and one automation hub VM instance for the {PlatfromNameShort} deployment.</p>
</li>
<li>
<p>Wait for the automation controller Auto Scale group and the automation hub Auto Scaling group to create new VM instances.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The new administrator can be used when the new automation controller and automation hub VM instances reach a <em>Running</em> Instance State.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="ref-aap-gcp-security-considerations"><a class="anchor" href="#ref-aap-gcp-security-considerations"></a>4.2. Security considerations</h3>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-aap-gcp-automation-workloads"><a class="anchor" href="#assembly-aap-gcp-automation-workloads"></a>5. Automation workloads</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ansible Automation Platform from GCP Marketplace is designed to automate the number of managed nodes included with the offer identified at purchase time.
This is typically 100 nodes.</p>
</div>
<div class="paragraph">
<p>Consult your GCP offer used when deploying Ansible Automation Platform from GCP Marketplace.</p>
</div>
<div class="sect2">
<h3 id="ref-aap-gcp-automation-performance"><a class="anchor" href="#ref-aap-gcp-automation-performance"></a>5.1. Automation performance</h3>
<div class="paragraph">
<p>Automating against the managed node allotment in the offer is provided with the following operational expectations.
Automating outside of the boundaries of these criteria is not supported, but can still function depending on your automation.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Metric</th>
<th class="tableblock halign-left valign-top">Threshold</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Concurrent Jobs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Forks per job</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>TBD</p>
</div>
</div>
<div class="sect2">
<h3 id="ref-aap-gcp-deployment-scaling"><a class="anchor" href="#ref-aap-gcp-deployment-scaling"></a>5.2. Deployment scaling</h3>
<div class="paragraph">
<p>Extension nodes will become available after the initial release of Ansible Automation Platform from GCP Marketplace.
This documentation will be updated to describe how to purchase and connect extension nodes at that time.</p>
</div>
<div class="paragraph">
<p>If you want to scale your deployment beyond the initial number of supported managed nodes, Ansible Automation Platform from GCP Marketplace can be manually scaled using separately sold extension nodes.
Extension nodes are additional compute instances that can be deployed to scale-up or scale-out depending on the immediate scaling requirements.
If your requirements are for higher parallel automation operations you can select compute shapes that scale-up, while if you have a requirement to automate more nodes over time you can select compute shapes that scale out.</p>
</div>
<div class="paragraph">
<p>Extension nodes are the supported way of extending the capabilities of Ansible Automation Platform from GCP Marketplace.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Environments that are extended through customer design and implementation are not supported by Red Hat.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assembly-aap-gcp-monitoring-logging"><a class="anchor" href="#assembly-aap-gcp-monitoring-logging"></a>6. Monitoring and logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can send metrics to the Google Cloud Platform monitoring system to be visualized in the Google Cloud Platform UI.
Ansible Automation Platform from GCP Marketplace metrics and logging are disabled by default as there is a cost to send these metrics to GCP.
Refer to <a href="https://cloud.google.com/stackdriver/pricing#monitoring-costs">Cloud Monitoring</a> and <a href="https://cloud.google.com/stackdriver/pricing">Cloud Logging</a> respectively for more information.</p>
</div>
<div class="paragraph">
<p>Metrics are provided by <a href="https://docs.ansible.com/ansible-tower/latest/html/administration/metrics.html">Ansible</a>, <a href="https://github.com/containers/prometheus-podman-exporter">Podman</a> and <a href="https://cloud.google.com/stackdriver/docs/solutions/agents/ops-agent">Google Ops Agent</a>.
Ansible metrics is only installed on automation hub, the Google Ops Agent and Podman are also installed on automation controllers.</p>
</div>
<div class="paragraph">
<p>A configurable process (collector) runs on each automation controller and automation hub to export the collected Ansible and Podman metrics to Google Cloud Platform Monitoring.
As the Google Ops Agent is part of the Google Cloud solution, it has its own configuration file.</p>
</div>
<div class="paragraph">
<p>The Google Ops Agent is also responsible for the logging configuration.</p>
</div>
<div class="paragraph">
<p>The service APIs <code>monitoring.googleapis.com</code> and <code>logging.googleapis.com</code> must be respectively enabled for the monitoring and logging capabilities.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration"><a class="anchor" href="#_configuration"></a>7. Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Configuration files are located on a disk shared by each automation controller and automation hub.
Modify the file <code>/aap/common/bootstrap/config_file_templates/&lt;controller|hub&gt;/monitoring.yaml</code> to configure all exporters and agents.</p>
</div>
<div class="sect2">
<h3 id="ref-aap-gcp-ansible-podman-config"><a class="anchor" href="#ref-aap-gcp-ansible-podman-config"></a>7.1. Ansible and podman configuration</h3>
<div class="paragraph">
<p>The file `/aap/common/bootstrap/config_file_templates/&lt;controller|hub&gt;/monitoring.yaml' on automation controller or automation hub contains the configuration.</p>
</div>
<div class="paragraph">
<p>The default configuration for automation controller looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># This value will be set at deployment time.
# Set to zero if loggingEnabled is false otherwise 59s
# The collection interval for each collector will be the minimum
# between the defaultCollectorInterval and all send Interval
# of a given collector
# NB: The awx exported should not run on controllers as
# it duplicates the number of records sent to GCP Monitoring

defaultCollectorInterval: $DEFAULT_COLLECTOR_INTERVAL
collectors:
- name: podman
 endpoint: http://localhost:9882/podman/metrics
 enabled: true

# list of metrics to exclude
# excludedMetrics:
# - podman_container_created_seconds

 metrics:
 - name: podman_container_exit_code
   # interval on which the metric must be pushed to gcp
   sendInterval: 59s</pre>
</div>
</div>
<div class="paragraph">
<p>The default configuration for automation hub looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># This value will be set at deployment time.
# Set to zero if loggingEnabled is false otherwise 59s
# The collection interval for each collector will be the minimum
# between the defaultCollectorInterval and all sendInterval
# of a given collector
# NB: The awx exporter should not run on controllers as
# it duplicates the number of records sent to GCP Monitoring
defaultCollectorInterval: 59s
collectors:
- name: awx
 userName: admin
 endpoint: http://&lt;Controller_LB_IP&gt;/api/v2/metrics/
 enabled: true
 metrics:
 - name: awx_inventories_total
   # interval on which the metric must be pushed to gcp
   sendInterval: 59s
- name: podman
 endpoint: http://localhost:9882/podman/metrics
 enabled: true
# list of metrics to exclude
#  excludedMetrics:
#  - podman_container_created_seconds
 metrics:
 - name: podman_container_exit_code
   # interval on which the metric must be pushed to gcp
   sendInterval: 59s</pre>
</div>
</div>
<div class="paragraph">
<p>where</p>
</div>
<div class="paragraph">
<p><code>collectors</code> is a configuration array with one item per collector, that is, awx and podman.</p>
</div>
<div class="paragraph">
<p>The awx collector requires authentication and so <code>userName</code> must be set to <code>admin</code>.
The password is retrieved from the secret-manager.</p>
</div>
<div class="paragraph">
<p>The endpoint should not be changed.</p>
</div>
<div class="paragraph">
<p><code>defaultCollectorInterval</code> specifies the default interval at which the exporter collects the information from the metric end-point and sends it to Google Cloud Platform Monitoring.</p>
</div>
<div class="paragraph">
<p>Setting this value to <code>0</code> or omitting this attribute disables all collectors.</p>
</div>
<div class="paragraph">
<p>Each collector can be enabled or disabled separately by setting <code>enabled</code> to <code>true</code> or <code>false</code>.</p>
</div>
<div class="paragraph">
<p>A collector returns all available metrics grouped by families, but you can exclude the families that should not be sent to Google Cloud Platform Monitoring by adding their name in the array <code>excludedMetrics</code>.</p>
</div>
<div class="paragraph">
<p>For all other family metrics, you can specify the interval at which you want to collect and send them to the Google Cloud Platform Monitoring.
The collector interval is the minimum between all family metrics interval and the <code>defaultCollectorInterval</code>.
This to ensure that a collection is made for each set of metrics sent to Google Cloud Platform Monitoring.</p>
</div>
</div>
<div class="sect2">
<h3 id="proc-aap-gcp-change-config-controller-hub"><a class="anchor" href="#proc-aap-gcp-change-config-controller-hub"></a>7.2. Changing the configuration of automation hub or automation controller</h3>
<div class="paragraph">
<p>If you want to have a different configuration for automation controller and automation hub, you must follow the steps below for each automation controller or automation hub that you want a different configuration for.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Login on the automation controller or automation hub.</p>
</li>
<li>
<p>To login as a super user run :</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># su -</pre>
</div>
</div>
</li>
<li>
<p>To have one file per server for either {ControllerNaame} or automation hub, copy the file
<code>/aap/common/bootstrap/config_file_templates/&lt;controller|hub&gt;/monitoring.yaml</code>
to
<code>/aap/common/bootstrap/config_file_templates/&lt;controller|hub&gt;/monitoring-$HOSTNAME.yaml</code>.</p>
</li>
<li>
<p>To login as the awx user run:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># su - awx</pre>
</div>
</div>
</li>
<li>
<p>To remove the current exporter run:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ podman rm aoc-metric-exporter –force</pre>
</div>
</div>
</li>
<li>
<p>To start the export with the newly created configuration file (<code>monitoring=$HOSTNAME.yaml</code>).run:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ podman run -d --name=aoc-metric-exporter --network=host \
-v  ${CONFIG_DIR}:/config:ro \
quay.io/ansible-on-clouds/aoc-metric-exporter:latest \
gcp \
--collectors-config-file /config/monitoring-$HOSTNAME.yaml\
--awx-password-secret-name ${GCP_ADMIN_SECRET_NAME} \
--project ${PROJECT}</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Where <code>GCP_ADMIN_SECRET_NAME</code> is the result of</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ curl "http://metadata.google.internal/computeMetadata/v1/instance/attributes/gcp-admin-secret-name" -H "Metadata-Flavor: Google" 2&gt;/dev/null</pre>
</div>
</div>
<div class="paragraph">
<p>and PROJECT is the name of your project.</p>
</div>
</div>
<div class="sect2">
<h3 id="proc-aap-gcp-configure-google-cloud-ops-agent"><a class="anchor" href="#proc-aap-gcp-configure-google-cloud-ops-agent"></a>7.3. Google cloud ops agent configuration</h3>
<div class="paragraph">
<p>The configuration file details can be found <a href="https://cloud.google.com/stackdriver/docs/solutions/agents/ops-agent/configuration">here</a>.</p>
</div>
<div class="paragraph">
<p>The configuration file is located in <code>/etc/google-cloud-ops-agent.yaml</code>
This is a symbolic link to the shared disk <code>/app/bootstrap/config_file_templates/controller/gcp-ops-agent-config.yaml</code> or <code>/app/bootstrap/config_file_templates/hub/gcp-ops-agent-config.yaml</code> depending on the component type.</p>
</div>
<div class="paragraph">
<p>Logging and monitoring are not enabled by default, however, the configuration file contains the default configuration.
If you want to add the logging or metrics, you can concatenate the files named <code>gcp-ops-agent-config-metric.yaml</code> and <code>gcp-ops-agent-config-logging.yaml</code> located in the same directory into the <code>gcp-ops-agent-config.yaml</code>.</p>
</div>
<div class="paragraph">
<p>A crontab job restarts the agent if <code>gcp-ops-agent-config.yaml</code> changed in the last 10 minutes and thus the agent rereads its configuration.</p>
</div>
<div class="paragraph">
<p>To have different configurations per automation controller and automation hub, the following procedure must be applied for each automation controller or automation hub that you want a different configuration for.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-11-18 09:51:05 UTC
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>