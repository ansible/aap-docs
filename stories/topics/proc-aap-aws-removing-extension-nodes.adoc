[id="proc-aap-aws-removing-extension-nodes"]

= Removing the extension nodes

The following instructions describe how to run the playbook to remove the extension nodes.

.Procedure
. Pull the Docker image for `ansible-on-clouds-ops` container image with a tag the same as the version you are currently using.

[NOTE]
=====
The `ansible-on-clouds-ops` container image tag must match the current installed version of {AAPonAWS}
=====

[source,bash]
----
$ export IMAGE=<image-path>
$ docker pull $IMAGE
----

. Run the upgrade playbook as a container using the following command.
Replace `<removal-name>` with your foundation deployment name. 

[source,bash]
----
# Export the volume paths
$ export VOLUME_AWS_CREDENTIALS_DIR=<absolute path to workdir>/secrets
$ export VOLUME_EXTRA_VARS_DIR=<absolute path to workdir>/extra_vars

# Run the playbook
$ docker run --rm \
    --env PLATFORM=AWS \
    --env removal_NAME=<removal-name> \
    -v ${VOLUME_AWS_CREDENTIALS_DIR}:/home/runner/.aws/:rw \
    -v ${VOLUME_EXTRA_VARS_DIR}:/extra_vars:ro \
    ${IMAGE} \
      redhat.ansible_on_clouds.aws_remove_extension_nodes \
      -e @/extra_vars/extra_vars.yml
----
