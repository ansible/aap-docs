[id="proc-gcp-run-backup-playbook"]

= Running the backup playbook

.Procedure
. To run the backup, run the command generator to generate the backup command.
+
[source,bash]
----
docker run --rm -v /tmp:/data $IMAGE command_generator gcp_backup_deployment --data-file /data/backup.yml
----
+
Resulting in the following ouput:
+
[source,bash]
----
-----------------------------------------------
Command to run playbook: 

docker run --rm --env PLATFORM=GCP -v <local_credential_file>:/home/runner/.gcp/credentials:ro \
--env ANSIBLE_CONFIG=../gcp-ansible.cfg  $IMAGE redhat.ansible_on_clouds.gcp_backup_deployment \
-e 'gcp_service_account_credentials_json_path=/home/runner/.gcp/credentials  \
gcp_deployment_name=<deployment_name> gcp_compute_region=<region> \
gcp_compute_zone=<zone> gcp_bucket_backup_name=<bucket>’
----
. Run the supplied backup command to trigger the backup.
+
[source,bash]
----
$ docker run --rm --env PLATFORM=GCP -v <local_credential_file>:/home/runner/.gcp/credentials:ro \
--env ANSIBLE_CONFIG=../gcp-ansible.cfg  $IMAGE redhat.ansible_on_clouds.gcp_backup_deployment \
-e 'gcp_service_account_credentials_json_path=/home/runner/.gcp/credentials  \
gcp_deployment_name=<deployment_name> gcp_compute_region=<region> \
gcp_compute_zone=<zone> gcp_bucket_backup_name=<bucket>’
----
. When the playbook has finished running, the output resembles the following:
+
[source,bash]
----
TASK [redhat.ansible_on_clouds.standalone_gcp_backup : [backup_deployment] Print vars required for restore process] ***
ok: [localhost] => 
  msg:
  - AAP on GCP Backup successful. Please note below the bucket name which is required for restore process.
  - <bucket_name>

PLAY RECAP **********************************************************************************************
localhost          : ok=33   changed=6    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0
----


