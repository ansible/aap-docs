:_content-type: PROCEDURE

[id="single-task-recs_{context}"]
= Creating single task recommendations

[role="_abstract"]
You can request code recommendations for a single task by entering natural language prompts in Ansible VS Code extension. For example, to automate a task of installing a PostgreSQL server, you can enter the prompt `- name: Install postgresql-server`. The Ansible Lightspeed service reads the text, interacts with the {ibmwatsonxcodeassistant} model, and generates the code recommendations.

.Prerequisites

* You meet *one* of the following requirements:

** Your organization has a trial or paid subscription to both the {PlatformName} and {ibmwatsonxcodeassistant}.
** Your organization has a trial or paid subscription to the {PlatformName}, and you have a {LightspeedShortName} trial account.

* You have xref:con-configure-vs-code-extension_developing-ansible-content[installed and configured the Ansible VS Code extension].

.Procedure

. Log in to VS Code with your Red Hat account.
. Create a new YAML file or use an existing YAML file: 
* Create a YAML file: 
... Select menu:File[New Text File].
... From the lower right of the screen, click *Plain Text*, and in the language mode, select *Ansible*. 
... Save the file as a YAML file format extension (`.yml` or `.yaml`).
* Use an existing YAML file: 
... On the bottom right of the screen, click the existing language mode, and in the language mode settings, select *Ansible*. 
+
[NOTE]
====
If you do not see the language mode section in your VS Code editor, from the Command Palette, select menu:Configure Language Mode[Ansible].
====
+
. Verify that you see an entry for *Lightspeed* on the status bar at the lower right of VS Code.
+
If *Ansible* is already selected as the desired language but the *Lightspeed* entry is not displayed, re-select *Ansible* as the language mode. The following illustration shows *Lightspeed* and *Ansible* entries on the VS Code status bar. 
+

.Ansible and Lightspeed set as selected language mode
image::lightspeed-vs-code.png[Settings show Ansible and Lightspeed as selected language mode]

. Optional: If you see an error message about missing Ansible lint, you can install the missing module or disable it. Perform any one of the following tasks:
* Install Ansible lint: For installation information, see the link:https://ansible.readthedocs.io/projects/lint/installing/[Installing] section of the Ansible Lint documentation. 
* Disable Ansible lint: 
... From the Activity bar, click the *Extensions* icon image:extensions-icon-vscode.png[Extensions].
... From the *Installed* extensions list, select *Ansible*.
... From the *Ansible* extension page, click the *Settings* icon and select *Extension Settings*.
... Clear the *Ansible › Validation › Lint: Enabled* checkbox.   

. Create a playbook or use an existing playbook. 
+
For more information, see the link:{URLPlaybooksGettingStarted}[{TitlePlaybooksGettingStarted}] guide.

+
. In the playbook, provide the following information to request code recommendations for a single task:
... Add a new Ansible task by starting a new line with `- name:` at the correct indentation.
... Add a detailed natural language prompt in the task description after `- name:` on the same line. 
For example, you can specify the following single task prompt:
`- name: Install postgresql-server`
... Press *Enter* directly after the task description. Keep the cursor at the same location in your file, and wait for the code recommendation results to populate.
+
The Ansible Lightspeed service is engaged, and it starts generating code recommendations for a single task. 
+
[IMPORTANT]
====
Ansible Lightspeed service takes around 5 seconds per task to populate the code recommendations. If you are using a multitask prompt, the Ansible Lightspeed service takes a bit longer (number of tasks times 5 seconds) to populate the results. Do not move your cursor or press any key while the code recommendation is being generated. If you change the cursor location or press any key, Ansible VS Code extension cancels the request and the Ansible Lightspeed service does not process your request.
====
+
When the Ansible Lightspeed service is engaged, a *Lightspeed* processing status indicator is displayed in the lower right of the screen to denote that your code recommendation is being generated.
+
image:lightspeed-task-in-progress.png[Lightspeed icon] 

. View your code recommendations and ensure that the recommendations match your task intent.
+
The following illustration shows the code recommendations generated by the Ansible Lightspeed service for the single task *Install postgresql-server*:
+
image:lightspeed-single-task-in-progress.png[Lightspeed single task in progress] 

. Accept or reject the code recommendations:
* To accept a code recommendation, press *Tab*.
* To reject a code recommendation, press *Esc*. 
+
[NOTE]
====
If you reject a recommendation, you can modify the prompt and review the generated code recommendations once again to match your task intent.
==== 

. On the *ANSIBLE: LIGHTSPEED TRAINING MATCHES* tab, view the content source matching results. 
+
The following illustration shows the training matches found in existing Ansible Galaxy content for the task prompt *Install postgresql-server*:
+
image::single-task-training-content-match.png[training matches in existing content]

. Click *Save* to save the code recommendation changes in your Ansible YAML file. 

[role="_additional-resources"]
.Additional resources

* xref:ref-troubleshooting-vscode_troubleshooting-lightspeed[Troubleshooting Ansible Visual Studio Code extension errors]
* xref:ref-troubleshooting-code-bot_troubleshooting-lightspeed[Troubleshooting {AnsibleCodeBot} errors]
