:_content-type: PROCEDURE

[id="troubleshooting-lightspeed-onpremise-config_{context}"]
= Troubleshooting {LightspeedShortName} on-premise deployment errors

== Cannot log in to the Ansible Lightspeed portal
After you configure a {LightspeedShortName} on-premise deployment and try to log in to the Ansible Lightspeed portal, the log-in attempt fails. The following scenarios are possible:

* The log-in attempt fails with the following error message:
+
`Error: invalid_request`
+
`Mismatching redirect URL`
+
This error indicates an incorrect configuration of the login redirect URI. The redirect URI parameter must contain the URL of the {LightspeedShortName} instance along with `/complete/aap/` suffix. The following is an example of the login redirect URI:
+
`https://lightspeed-on-prem-web-service.com/complete/aap/`
+
For more information, see xref:update-redirect-uri_configuring-lightspeed-onpremise[Updating the Redirect URIs].

* The log-in attempt fails with the following error message:
+
`Error: invalid_request`
+
`Invalid client_id parameter value`
+
This error indicates that the authorization connection secret contains an incorrect *client ID* value. To resolve this error, ensure that you have not accidentally added any whitespace characters (extra line, space, and so on) to the `auth_api_key` parameter in the authorization connection secret. For more information, see xref:create-connection-secrets_configuring-lightspeed-onpremise[Creating connection secrets].

* The log-in attempt fails with the following error message:
+
`ERROR: Your credentials aren't allowed`
+
`You currently do not have access to.`
+
This error indicates that the authorization connection secret contains an incorrect *client secret* value. To resolve this error, ensure that you have not accidentally added any whitespace characters (extra line, space, and so on) to the `auth_api_secret` parameter in the authorization connection secret. For more information, see xref:create-connection-secrets_configuring-lightspeed-onpremise[Creating connection secrets].

* The log-in attempt fails with the following error message:
+
`Not Found`
+
`The requested resource could not be found.`
+
This error indicates that an incorrect *API URL* value was used to create an authorization connection secret. To resolve this error, ensure that the `auth_api_url` parameter contains the prefix `https://` and suffix `/api/`. For more information, see xref:create-connection-secrets_configuring-lightspeed-onpremise[Creating connection secrets].

* The log-in attempt fails with the following error message:
+
`Server Not Found`
+
This error indicates that the *API URL* value in the authorization connection secret does not contain the suffix `/api/`. To resolve this error, ensure that the `auth_api_url` parameter contains the suffix `/api/`. For more information, see xref:create-connection-secrets_configuring-lightspeed-onpremise[Creating connection secrets].

* The log-in attempt fails with the following error message:
+
`Server Error (500)`
+
This error message indicates the service has internal errors or that the authorization connection secret contains incorrect *API URL* value. To resolve this error, ensure that the `auth_api_url` parameter contains the prefix `https://` and not `http://`. For more information, see xref:create-connection-secrets_configuring-lightspeed-onpremise[Creating connection secrets].

* The log-in attempt fails with the following error message:
+
`Bad Request (400)`
+
To resolve this error, check the `auth_allowed_hosts` parameter in the authorization secret. For test diagnosis, use the asterisk (*) sign. For more information, see xref:create-connection-secrets_configuring-lightspeed-onpremise[Creating connection secrets].

== Cannot log out of the Ansible Lightspeed portal

After you log out from the Ansible Lightspeed portal, you are redirected to the automation controller API page instead of Ansible Lightspeed.

This error indicates that the logout redirect URI was not configured while setting up your {LightspeedShortName} on-premise deployment. You must configure the logout redirect URI by adding the *LOGOUT_ALLOWED_HOSTS* entry to the YAML file. For more information, see xref:update-redirect-uri_configuring-lightspeed-onpremise[Updating the Redirect URIs].

== Cannot connect to the Ansible Lightspeed service from the Ansible VS Code extension
The following scenarios are possible:

* The log-in attempt fails with the following error message:
+
`Enable lightspeed services from settings to use the feature.`
+
This error indicates that Ansible Lightspeed is not enabled in the Ansible VS Code extension. To resolve this error, perform the following tasks:

. Open the VS Code application.
. From the *Activity* bar, click the *Extensions* icon.
. From the *Installed Extensions* list, select *Ansible*.
. From the *Ansible* extension page, click the *Settings* icon (image:settings-icon-ansible-vscode-extension.png[Settings icon]) and select *Extension Settings*.
. Select *Ansible Lightspeed* settings and then select the *Enable Ansible Lightspeed* checkbox.

* You are redirected to an incorrect Ansible Lightspeed instance on clicking the btn:[Connect] button.
+
This error indicates an incorrect route URL was used while configuring the Ansible Lightspeed service in Ansible VS Code extension. Ensure that you have configured the correct value in the route URL without any suffix. For more information, see xref:configure-vscode-extension-onpremise-deployment_configuring-lightspeed-onpremise[Configuring Ansible VS Code extension for Red Hat Ansible Lightspeed on-premise deployment].

* Cannot request code recommendations
+
The following error message is displayed: 
+
`An error occurred attempting to complete your request. Please try again later.`
+
This error indicates that the Ansible Lightspeed service is not running or is running with issues. Please check the Lightspeed service logs (the pod with suffix `-api`) for more details and error codes. 

* Cannot request code recommendations
+
The following error message is displayed:
+
`The {ibmwatsonxcodeassistant} is unavailable. Please try again later.`
+
or:
+
`{ibmwatsonxcodeassistant} Model ID is invalid. Please contact your administrator.`
+
This error indicates that the model secret contains incorrect values. To resolve this error, ensure that you have not accidentally added any whitespace characters (extra line, space, and so on) to the `username`, `model_url`, and `model_api_key` parameters in the model connection secret. For more information, see xref:create-connection-secrets_configuring-lightspeed-onpremise[Creating connection secrets]. 
